/*pub-1|2012-03-30 19:42:30*/(function(){var A=KISSY,C=A.DOM,B=A.Event;A.app("Vertical")})();Vertical.add("Header",function(C){var F=KISSY,A=F.DOM,L=F.Event,I=F.UA,B=F.IO,J="ts-show";var K=function(){var O,Q,P,N,M,S,R,D,E;return{init:function(T){O=F.get("label.J_Placeholder",T);Q=F.get("input.J_KeyWord",T);P=F.get(".J_SearchTB",T);N=F.get(".J_SearchMarket",T);M=F.get(".J_FormTB",T);S=F.get(".J_FormMarket",T);R=F.get(".J_Type",T);D=F.get(".J_MarketId",T);if(!O||!Q){return }if(!E){E=(function(X){var V=document.createElement("input");V.setAttribute("type","hidden");V.setAttribute("name","initiative_id");function W(){var Z=new Date();var a=Z.getMonth()+1;if(a<10){a="0"+a}var Y=Z.getDate();if(Y<10){Y="0"+Y}return[Z.getFullYear(),a,Y].join("")}V.value=X+"_"+W();return V})("listz");A.append(E,M)}if(R){L.on(R,"mouseenter mouseleave",function(V){if(V.type=="mouseenter"){A.addClass(this,"hover")}else{A.removeClass(this,"hover")}});L.on(F.query("li",R),"click",function(b){var V=F.get("a",this),c=A.attr(V,"data-type"),X=A.attr(V,"data-action"),a=A.attr(V,"data-allaction"),Z=A.attr(V,"data-target"),W=A.attr(V,"data-cat"),Y=c==="item"?"":Z;A.attr(S,"action",X);A.attr(M,"action",a||X);A.val(D,W);A.attr(N,"data-target",Z);A.attr(P,"data-target",Y);A.prepend(this,F.get("ul",R));A.removeClass(R,"hover");if(H){H.ON=c==="item"}if(c==="item"){A.append(E,M)}else{A.remove(E)}})}F.later(function(){if(F.trim(Q.value)!=""){A.removeClass(O,J)}if(A.get("#J_SearchKeyWord")&&A.val("#J_SearchKeyWord")!=""){Q.value=A.val("#J_SearchKeyWord");A.removeClass(O,J)}},100);L.on(Q,"focus blur",function(){if(!F.trim(this.value)){A.toggleClass(O,J)}});L.on([P,N],"click",function(X){X.halt();var V=Q.value;if(V){Q.value=V.replace(/<[^<>]*?>/g,"")}else{if(this==N){location.href=A.attr(this,"data-target")}else{location.href=A.attr(this,"data-target")||"http://s.taobao.com"}return }if(X.currentTarget==N){var W,Z,Y,a=A.val(D);itemList=a.split("&");if(itemList.length>0){A.val(D,itemList[0])}for(W=1;W<itemList.length;W++){Z=itemList[W].split("=");if(Z.length>1){Y=A.get(".J_auto_"+Z[0],S);if(!Y){Y=document.createElement("input");A.attr(Y,"type","hidden");A.attr(Y,"name",Z[0]);A.addClass(Y,"J_auto_"+Z[0]);A.append(Y,S)}A.val(Y,Z[1])}}S.submit()}else{if(X.currentTarget==P){F.get(".J_SearchWord",M).value=V;M.submit()}}});if(I.ie===6){var U="";L.on([P,N],"mouseenter mouseleave",function(V){U="btn1-hover";if(V.currentTarget==P){U="btn2-hover"}if(V.type=="mouseenter"){A.addClass(V.currentTarget,U)}else{A.removeClass(V.currentTarget,U)}})}}}}();var H=function(){return{init:function(){var E=A.get("#ts-keyword"),D=this;F.use("suggest",function(M){if(!E){return }D.suggest=new F.Suggest(E,"http://suggest.taobao.com/sug?area=auction&code=utf-8",{resultFormat:"\u7ea6%result%\u4e2a\u5b9d\u8d1d"});D.suggest.on("beforeStart",function(N){return D.ON})})},ON:true}}();var G=function(){var D=false;function E(){var N=F.get(".J_MoreMarketsT"),M=F.get(".J_MoreMarkets");function O(){D=true;var Q="http://www.taobao.com/go/rgn/vertical/jsonp.php",S="cb",R="moreMarketsCallback";var P={market:'<dt><a href="{href}" target="_blank">{text}</a></dt>',sub_market:'<dd><a href="{href}" target="_blank">{text}</a></dd>'};B({url:Q,success:function(T){F.each(T,function(W){var U=A.create("<dl></dl>");A.append(U,M);var V=A.create(F.substitute(P.market,{href:W.href,text:W.text}));A.append(V,U);sub_markets=W.subMarkets;F.each(sub_markets,function(X){var Y=A.create(F.substitute(P.sub_market,{href:X.href,text:X.text}));A.append(Y,U)});A.css(M,{background:"#fff",height:"auto"})})},error:function(){D(false);F.log("get more markets error!")},dataType:"jsonp",jsonp:S,jsonpCallback:R})}L.on([N,M],"mouseenter mouseleave",function(P){if(P.type==="mouseenter"){A.addClass(N,"m-hover");A.show(M);if(D==false){O()}}else{A.removeClass(N,"m-hover");A.hide(M)}})}return{init:function(){E()}}}();C.Header={init:function(){var D=A.get("#J_C2C_Search");if(!D){return }K.init(D);H.init();G.init()}}});Vertical.add("nav",function(G){var H=KISSY,A=H.DOM,O=H.Event,J=H.UA,N;function L(){var E=H.one(".J_AllNav").one("textarea");H.use("overlay",function(Q){var P=new Q.Popup(Q.get(".J_AllNav"),{trigger:".J_AllItems",triggerType:"mouse",align:{node:".J_AllItems",points:["bl","tl"],offset:[0,0]},zIndex:9999});P.on("show",function(){if(E){Q.use("datalazyload",function(R){R.DataLazyload.loadCustomLazyData(R.one(".J_AllNav").one(".ks-contentbox"),"textarea","ks-datalazyload-custom");E=false;D()})}Q.one(".J_AllItems").addClass("hover up")});P.on("hide",function(){Q.one(".J_AllItems").removeClass("hover up")})});function D(){if(J.ie!==6){return }O.on(H.query("li",H.get(".J_AllNav")),"mouseenter mouseleave",function(P){if(P.type=="mouseenter"){A.addClass(P.target,"i-hover")}else{A.removeClass(P.target,"i-hover")}})}if(E){D()}}function I(P,E){if(!A.get(P)||!A.get(E)){return }var S,D,Q=A.docWidth(),R=(Q-990)/2;D=A.offset(P).left,trigger_width=A.width(P),panel_width=A.width(E),S=D+trigger_width/2-panel_width/2+10;if(S<R){S=R+10}if(S>(R+990-panel_width)){S=R+980-panel_width}A.css(E,"left",S-R+"px")}function K(){if(J.ie!==6){return }O.on(".J_SubNavTgs","mouseenter mouseleave",function(D){if(D.type==="mouseenter"){A.addClass(this,"a-hover")}else{A.removeClass(this,"a-hover")}});H.each(A.query(".panel"),function(D){O.on(H.query("dd",D),"mouseenter mouseleave",function(E){E.type==="mouseenter"?A.addClass(this,"dd-hover"):A.removeClass(this,"dd-hover")})})}function C(D){if(A.get("#J_SubNav_"+D)&&A.children("#J_SubNav_"+D).length!=0){A.show("#main-sub-nav");A.addClass("#main-sub-nav","c-select");A.show("#J_SubNav_"+D);I("#J_Nav_"+D,"#J_SubNav_"+D);N="#J_SubNav_"+D}A.addClass("#J_Nav_"+D,"select")}function F(P,E){if(A.get("#J_Nav_"+P)){A.addClass("#J_Nav_"+P,"select")}else{if(A.get("#J_SubNav_"+E+" .J_OldNavId_"+P)){A.addClass(A.get("#J_SubNav_"+E+" .J_OldNavId_"+P),"select")}else{if(A.children("#J_SubNav_"+E).length!=0){A.addClass(A.children("#J_SubNav_"+E)[P],"select")}}}if(E==="noNavId"||!A.get("#J_Nav_"+E)){var D=A.parent(A.get("#J_Nav_"+P),".J_SubNavContainer");if(D){E=A.attr(D,"id").substr(9);C(E)}}}function M(){var Q,P=[],E=H.all(".J_NavItem","#main-nav"),S=/J_Nav_(.*)/,D,V=false,T="c-select";function R(){A.removeClass("#main-sub-nav","c-hover");N&&A.show(N)}function U(){A.removeClass(Q,"hover");A.hide(P)}Q=A.filter(E,function(W){var X=W.id.match(S)[1];if(A.get("#J_SubNav_"+X)&&A.children("#J_SubNav_"+X).length!=0){W.sub=A.get("#J_SubNav_"+X);P.push(A.get("#J_SubNav_"+X));return true}else{return false}},"#main-nav");O.on(Q,"mouseenter mouseleave",function(Y){var W=this;if(A.hasClass(W,"select")){return false}D&&D.cancel();if(Y.type==="mouseenter"){if(!A.hasClass("#main-sub-nav",T)&&!V){V=true;var X=A.width("#main-nav");A.css("#main-sub-nav",{position:"absolute",width:X})}D=H.later(function(){U();A.addClass("#main-sub-nav","c-hover");A.addClass(W,"hover");A.show(W.sub);if(!W.aligned){I(W,W.sub);W.aligned=true}},200)}else{D=H.later(function(){U();R()},200)}});O.on(P,"mouseenter",function(W){D&&D.cancel()});O.on(P,"mouseleave",function(W){D=H.later(function(){U();R()},200)})}function B(){if(!arguments.callee.exed){arguments.callee.exed=0}if(!arguments.callee.navId){if(arguments.callee.exed<50&&!A.get("#J_NavId")){arguments.callee.exed++;H.later(arguments.callee,50);return }var E;E=A.val("#J_NavId");E&&C(E);arguments.callee.navId=E||"noNavId";K()}if(arguments.callee.exed<50&&!A.get("#J_SubNavId")){arguments.callee.exed++;H.later(arguments.callee,50);return }var D;D=A.val("#J_SubNavId");D&&F(D,arguments.callee.navId)}G.Nav={init:function(){B();H.available("#main-sub-nav",function(){M()});H.available("J_AllCatNav",function(){if(window!=top){var D=A.attr(".J_AllItems","data-href");A.html(A.get(".J_AllItems"),'<a target="_top" href="'+D+'">\u6240\u6709\u5b9d\u8d1d</a>')}else{L()}})}}});Vertical.Nav.init();/*pub-2|2011-10-28 21:11:50*/this.BabyMarket=this.BabyMarket||{},function(a,b){var c={};b.Msg={publish:function(a,b){var d,e,f;c[a]||(c[a]={fns:[]}),c[a].value=b,d=c[a].fns;for(e=0,f=d.length;e<f;e++)d[e](b)},watch:function(a,b){c[a]||(c[a]={fns:[]}),c[a].fns.push(b)},get:function(a){var b=c[a];return b?b.value:undefined}}}(KISSY,BabyMarket);/*pub-2|2011-11-02 10:19:35*/(function(a){function b(a,b){var c,d,e=function(a){if(a&&a.type=="DOMContentLoaded")f();else if(a&&a.type=="load")f();else if(document.readyState)if(/loaded|complete/.test(document.readyState))f();else if(!!document.documentElement.doScroll){try{c||document.documentElement.doScroll("left")}catch(a){return}f()}},f=function(){c||(c=!0,a.call(b||window),document.removeEventListener&&document.removeEventListener("DOMContentLoaded",e,!1),document.onreadystatechange=null,window.onload=null,clearInterval(d),d=null)};document.addEventListener&&document.addEventListener("DOMContentLoaded",e,!1),document.onreadystatechange=e,d=setInterval(e,5),window.onload=e}b(function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;try{d=a.querySelectorAll("*[spm_module_id]")}catch(q){b=a.getElementsByTagName("*"),d=[];for(l=0,m=b.length;l<m;l++)c=b[l],c.getAttribute("spm_module_id")&&d.push(c)}for(l=0,m=d.length;l<m;l++){e=d[l],f=e.getAttribute("spm_module_id"),g=e.getElementsByTagName("a"),typeof spmId!="undefined"&&f.indexOf(spmId)==-1&&(p=f.split("."),p.length==3&&(f=spmId+"."+p[2]));for(n=0,o=g.length;n<o;n++){h=g[n],i=h.href;if(!i)continue;i=i.match(/([^?#]+)(?:\?([^#]*))?(.*)$/),j=i[1],k=i[2],hash=i[3],k?k=k.replace(/&?spm=[^&]*/g,""):k="",k&&k.indexOf("&")!=0&&(k="&"+k);var r=h.innerHTML;h.setAttribute("href",j+"?spm="+f+"."+(n+1)+k+hash),h.innerHTML=r}}})})(document);